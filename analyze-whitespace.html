<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>상단 공백 분석</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .element {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #444;
            background: #2a2a2a;
        }
        .warning {
            background: #442222;
            border-color: #ff4444;
        }
        .info {
            background: #224422;
            border-color: #44ff44;
        }
    </style>
</head>
<body>
    <h1>상단 공백 분석 도구</h1>
    <button onclick="analyzeWhitespace()">분석 시작</button>
    <div id="results"></div>

    <script>
        function analyzeWhitespace() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>분석 중...</h2>';
            
            // iframe으로 사이트 로드
            const iframe = document.createElement('iframe');
            iframe.src = 'http://localhost:5173';
            iframe.style.width = '100%';
            iframe.style.height = '600px';
            iframe.style.border = '2px solid #666';
            
            iframe.onload = () => {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                const iframeWin = iframe.contentWindow;
                
                let html = '<h2>분석 결과</h2>';
                
                // 1. body와 html 스타일 분석
                const bodyStyles = iframeWin.getComputedStyle(iframeDoc.body);
                const htmlStyles = iframeWin.getComputedStyle(iframeDoc.documentElement);
                
                html += `<div class="element info">
                    <h3>Body/HTML 스타일</h3>
                    <p>Body margin: ${bodyStyles.margin}</p>
                    <p>Body padding: ${bodyStyles.padding}</p>
                    <p>HTML margin: ${htmlStyles.margin}</p>
                    <p>HTML padding: ${htmlStyles.padding}</p>
                </div>`;
                
                // 2. 상단 요소들 분석
                const allElements = iframeDoc.querySelectorAll('*');
                const topElements = [];
                
                allElements.forEach(el => {
                    const rect = el.getBoundingClientRect();
                    const styles = iframeWin.getComputedStyle(el);
                    
                    // 상단 100px 이내의 요소들
                    if (rect.top < 100 || (rect.bottom > 0 && rect.top < 0)) {
                        topElements.push({
                            element: el,
                            tagName: el.tagName,
                            className: el.className,
                            id: el.id,
                            rect: rect,
                            styles: styles
                        });
                    }
                });
                
                // 위치 순으로 정렬
                topElements.sort((a, b) => a.rect.top - b.rect.top);
                
                html += '<h3>상단 요소들 (위치 순)</h3>';
                
                topElements.slice(0, 10).forEach((item, index) => {
                    const isWarning = item.rect.height > 0 && item.rect.top >= 0 && index === 0 && item.rect.top > 5;
                    const className = isWarning ? 'element warning' : 'element';
                    
                    html += `<div class="${className}">
                        <h4>${item.tagName} ${item.id ? '#' + item.id : ''} ${item.className ? '.' + item.className : ''}</h4>
                        <p>위치: top=${item.rect.top.toFixed(2)}px, height=${item.rect.height.toFixed(2)}px</p>
                        <p>display: ${item.styles.display}, position: ${item.styles.position}</p>
                        <p>margin: ${item.styles.margin}, padding: ${item.styles.padding}</p>
                        ${isWarning ? '<p><strong>⚠️ 이 요소가 상단 공백을 만들고 있을 가능성이 높습니다!</strong></p>' : ''}
                    </div>`;
                });
                
                // 3. 첫 번째 가시적 요소 찾기
                let firstVisible = null;
                for (let el of allElements) {
                    const rect = el.getBoundingClientRect();
                    const styles = iframeWin.getComputedStyle(el);
                    if (rect.height > 0 && styles.visibility !== 'hidden' && 
                        styles.display !== 'none' && rect.top >= 0) {
                        firstVisible = {
                            element: el,
                            tagName: el.tagName,
                            className: el.className,
                            rect: rect
                        };
                        break;
                    }
                }
                
                if (firstVisible && firstVisible.rect.top > 5) {
                    html += `<div class="element warning">
                        <h3>⚠️ 상단 공백 발견!</h3>
                        <p>첫 번째 가시적 요소가 상단에서 ${firstVisible.rect.top.toFixed(2)}px 떨어져 있습니다!</p>
                        <p>요소: ${firstVisible.tagName} ${firstVisible.className ? '.' + firstVisible.className : ''}</p>
                    </div>`;
                }
                
                // 4. 특별 요소 검사
                const toastContainer = iframeDoc.querySelector('[data-sonner-toaster]');
                if (toastContainer) {
                    const rect = toastContainer.getBoundingClientRect();
                    const styles = iframeWin.getComputedStyle(toastContainer);
                    html += `<div class="element">
                        <h3>Toast Container 발견</h3>
                        <p>위치: top=${rect.top}px, height=${rect.height}px</p>
                        <p>display: ${styles.display}, position: ${styles.position}</p>
                    </div>`;
                }
                
                results.innerHTML = html;
                document.body.appendChild(iframe);
            };
        }
    </script>
</body>
</html>